<!DOCTYPE html>
<html>
<head>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.3.0/d3.min.js"></script>
	<script src="../../js/GeneView.js"></script>
	<style>
		html, body {
			height: 100% ;
			overscroll-behavior: none;
		}
		.figure {
			position: relative ;
		}
		.names {
			position: fixed ;
			top: 20px ;
			left: 20px ;
			width: 200px ;
			z-index: 10 ;
			background: white ;
			border-right: 1px solid gray ;
			/*border: 1px solid black ;*/
			padding: 0px ;
			margin: 0px ;
		}
		.sequences {
			position: fixed ;
			top: 20px;
			left: 220px ;
			border-left: 1px solid gray ;
			border-right: 1px solid gray ;
			border: 1px solid black ;
			padding: 0px ;
			margin: 0px ;
		}
		.genes {
			position: fixed ;
			left: 220px ;
			top: 600px ;
			height: 200px ;
			border-left: 1px solid gray ;
			border-right: 1px solid gray ;
			border: 1px solid black ;
			padding: 0px ;
			margin: 0px ;
		}
	</style>
</head>
<body>
	<section class="figure">
		<svg class = "names" width=900 height=600></svg>
		<!--svg class = "sequences" width=900 height=600></svg>-->
		<canvas class = "sequences" width=900 height=600></canvas>
		<svg class = "genes" width=900 height=200></svg>
	</section>
</body>
<script>
	console.log( "DATA" ) ;
	let data = {
		"alignment": [
			{ "name": "PPRFG01_11", "sequence": "-------------------------------------caaataatttttttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcttaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaaaaaaaaaat----atatatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaaaccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacataatatatatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaatcatgtctgtttattaacacatgtacatgtaatatat----------------tatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg----------------tatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa--cccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaa------------------------atatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagcattattattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaacaaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatataaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacgtat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatattattatacataaaataaccctttctttctaaaatctttt-aaaaaaaaaaacccaaataaaaaaagaataatatattataatatatatatatataaagaaaaaaa----------------------------------------" },
			{ "name": "PRG01_11", "sequence": "------------------------aaattattttcttcgaataatttttttatatagcttaataatttttcctccgaatatactcctaaaa--------aaaacaaaaaaaaaatgagataattaagaaaatacatatactaatata-------atatatatatgtatgaaaatatatactttcctttttcaaatattaaaaaattctgtttactcattatttttctcatttttattcttaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaaaaa----------------------aaatatataaatatatatatggttgtaattacataatattttacatatattcattttatcaaataattt-aaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctataaaaattaaaaaaaaaaatacattaggtattataaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttccattttttttatctttatctttttcttttcttttcttttgtgacgtactttctttaaagtagtattcataaagggcatatataattagcaaagctattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttgagacgttgaaaaaaaccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacataatatatatatatatatatatatattaaaatagatatatagatttgtacatgtattataatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaatcatgtctgtttattaacacatgtacatttaatatat--------tatatatatatatatatatatatatatatatattttaggtgacataatattttattttgtt---ttttttctagttcataccaccatgattatcaacgtctgtgttttctgcatcatttaatttattccacatttttc--ttttttttttaataatatataacaaattttaagactagaaaaaatcaagttttttccttgttttttttttta--tttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatgtatatatatatatatatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaa---ccccccccaaaaaaaag-aactacttttttatatcatatacattatataaa---------------------------------------------------------------------------------------------tatatatatatatattatataataatagtaggttaaaatttaatatgtttaattaataattattaaaa------------------------------atatatatatatatataagaaaaataaaattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaacttcaataaatattcaaaagc---attaataactaaaggttccataatataaaaaaatatatttcataaataattcttttatagaattataatatatatatataaataataatatatatatatatatatatatatatataataataaataaaagattaaaaaaaaaacaaaaattcaacttttctatttttagaaaaaatatatatg-aaaaaaaataagaaataaatttagggtagttttatttatatagaattcgtaaagatctatcatttcttataattatatgtatatataaaaaac-aaaaaacaaacaaattagtgttatatatata-----atatatattaaaatattatataataatatatggtttaattttattttatattattaatacgtataaattatatataatatttttttttttatatatataaaagaatctaatactatgtaacgatataataatatatatatttctaaaaataatt-taacaaagttcatcatttatatta-tatatataaaataaccctttctttctaaaatctttcaaaaa--aaaaaactaaataa-------------------------------------------------------------------------------------" },
			{ "name": "Pf7G8_11", "sequence": "----------------------------------------------tctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaa---atatatatatatatatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatacattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata--atatatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatatta------tatatatatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaacccccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaa----------------atatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacgtat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataatatatatatatataaa------------------------------------------------" },
			{ "name": "Pf7G8_tig00000002_pilon", "sequence": "----------------------------------------------tctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaa---atatatatatatatatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatacattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata--atatatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatatta------tatatatatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaacccccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaa----------------atatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacgtat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataatatatatatatataaa------------------------------------------------" },
			{ "name": "PfCD01_11", "sequence": "---------------------------------tcttcgaataatttctttatatagcttaataatttttcctccgaatatactcctaaacaaaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaatat-------atatatatatatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaattcatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata----atatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat--------------tatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcaacatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg------------tatatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa-ccccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaaa------------tatatatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatatatatatatatacacataatgtttacaata------------------------------aatgaatat-atctatatttataa--aattcttaaaagtatataagaggttc------------ataat---ataaacggaatgttttaat------------tttttttttttttttttttttttttctgctaaattatattactttattatgacccgttcataaagaaaaaaaaaaaaaaaaaaaaaaaaatatatatatatatatatatatacacataatgtttacaataaatgaatatatctatatttataaaattct-----" },
			{ "name": "PfDd2_11", "sequence": "--------------------------------------gaataatttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaa---------------atatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatacattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata----atatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatattatatatatatatatatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa-ccccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaa----------------------atatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacgtat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataatatatatatatataaagaaaaaa-----------------------------------------" },
			{ "name": "PfGA01_11", "sequence": "---------------------------------tcttcgaataatttctttatatagcttaataatttttcctccgaatatactcctaaacaaaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaa-------atatatatatatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaattcatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata----atatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat--------------tatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcaacatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg------------tatatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa-ccccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaa--------------atatatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatatatatatatatacacataatgtttacaata------------------------------aatgaatat-atctatatttataa--aattcttaaaagtatataagaggttc------------ataat---ataaacggaatgttttaa-------------tttttttttttttttttttttttttctgctaaattatattactttattatgacccgttcataa--aaaaaaaaaaaaaaaaaaaaaaaaatatatatatatatatatatatacacataatgtttacaataaatgaatatatctatatttataaaattcttaaaa" },
			{ "name": "PfGB4_11", "sequence": "--------------------------------ttcttcgaataatttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaaaa-----------atatatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata----atatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacacgtacatgtaatatat----------tatatatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacaac-aaaa-ccccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaa----------------a--tatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacctat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataatatatatatatataaagaaa--------------------------------------------" },
			{ "name": "PfGN01_11", "sequence": "aatgttaaattgtcactgtaggataaattattttcttcgaataatttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaat-----------------------------------------atatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata----atatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat------------tatatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa-ccccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaaaaatatatatatatatatatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacctat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataat---------------------------------------------------------------" },
			{ "name": "PfHB3_11", "sequence": "--------------------------------------------tttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaaaa-aaatatatatatatatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata--atatatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatatta----------tatatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa-ccccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaaa--tatatatatatatatatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacctat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataatat-------------------------------------------------------------" },
			{ "name": "PfIT_11", "sequence": "--------------------------------ttcttcgaataatttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaa---------atatatatatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagtgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatacattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata--atatatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat--------------tatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttcttttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa--cccccccaaaaaaaaag-aattgcttttttatatcatatacattatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaacccccccaaaaaaaaagaattgcttttttatatcatatacattatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaaa----tatatatatatatatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacgtat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaa-----------------------------------------------------------------------------------------------------------------------------------------------------------------" },
			{ "name": "PfKE01_11", "sequence": "------------------------aaattattttcttcgaataatttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaa-------------------atatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacataatatatatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat--------------tatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa-ccccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaat----------------atatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaattttccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacctat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataatatatatatatataaag-----------------------------------------------" },
			{ "name": "PfKH01_11", "sequence": "--------------------------------------------tttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaaaa---atatatatatatatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacataatatatatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat----------tatatatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa--cccccccaaaaaaaaag-aattgcttttttatatcatatacattatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaacccccccaaaaaaaaagaattgcttttttatatcatatacattatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaa----------atatatatatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacgtat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttga-----------------------------------------------------------------------------------------------------------------------------------------------------------" },
			{ "name": "PfKH02_11", "sequence": "---------------------------------tcttcgaataatttctttatatagcttaataatttttcctccgaatatactcctaaacaaaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaa---------atatatatatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagtgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatacattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata--atatatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat--------------tatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttcttttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa--cccccccaaaaaaaaag-aattgcttttttatatcatatacattatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaacccccccaaaaaaaaagaattgcttttttatatcatatacattatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaaa----tatatatatatatatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacgtat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaa-----------------------------------------------------------------------------------------------------------------------------------------------------------------" },
			{ "name": "PfML01_00_142", "sequence": "-----------------------------attttcttcgaataatttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaa----------------atatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata----atatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat--------tatatatatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttcttttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttattatttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa-ccccccccaaaaaaaaagaaattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaa--------------------atatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacgtat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataatatatatatatataaagaa---------------------------------------------" },
			{ "name": "PfNF135_tig00000002_pilon", "sequence": "-------------------------------------cgaataatttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaaaaaaaatatatatatatatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata--atatatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatatt------------------atatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg------------tatatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa-ccccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaa------------tatatatatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacgtat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataatatatatatat-----------------------------------------------------" },
			{ "name": "PfNF54_tig00000031_pilon", "sequence": "--------------------ggataaattattttcttcgaataatttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaa-----------------atatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata----atatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat----------------tatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacacc-aaaa-acccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaa--------------------atatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgttaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacctat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataatatatatatatataaagaaaaa------------------------------------------" },
			{ "name": "PfSD01_11", "sequence": "-----------------------------attttcttcgaataatttctttatatagcttaataatttttcctccgaatatactcctaaacaaaaaaaaaaaaaaaaaaaaaaatgaaataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaaaa-------------------atatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata--atatatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat--------tatatatatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacaccaaaaa--cccccccaaaaaaaaag-aattgcttttttatatcatatacatt---------------------------------------------------------------------------------------------------atatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaa----------aaatatatatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacctat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataatatatatata------------------------------------------------------" },
			{ "name": "PfSN01_11", "sequence": "--------------------ggataaattattttcttcgaataatttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaa-------------------atatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaattcatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata----atatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat--------------tatatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcaacatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg------------tatatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa-ccccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaaa------------tatatatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatatatatatatatacacataatgtttacaata------------------------------aatgaatat-atctatatttataa--aattcttaaaagtatataagaggttc------------ataat---ataaacggaatgttttaa---------------tttttttttttttttttttttttctgctaaattatattactttattatgacccgttcataa--agaaaaaaaaaaaaaaaaaaaaaaatatatatatatatatatatatacacataatgtttacaataaatgaatatatctatatttataaaattcttaaaa" },
			{ "name": "PfTG01_11", "sequence": "-------------------------------------cgaataatttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaaaatatatatatatatatatatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacataatatatatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat--------------------tatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatgt----------atatatatatatatatatatattataaattacaatattatgaatataactatatttacaacaaaaa-ccccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaa------------------aaatatatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgtaaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacctat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataatatatatatatataa-------------------------------------------------" },
			{ "name": "Pfsa3_101", "sequence": "-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------gttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaa----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------" },
			{ "name": "Pf3D7_11_v3", "sequence": "--------------------ggataaattattttcttcgaataatttctttatatagcttaataatttttcctccgaatatactcctaaac-aaaaaaaaaaaaaaaaaaaaaatgagataattaagaaaatatatatactaatataatgtattatatatatatgtatgaaaatatatactttcctttttcaaatattaaacaattctgtttactcattatttttctcatttttattcctaccattaaataatggaatactacttcttaatatataattattattttctgtattcacatcgacaatatgtaacctttcagctaaaaataaaaatatataaatataaaaaaaaaa-----------------atatatatatatatatatatatatatatggttgtaattacat-atattttatatatattcattttatcaaataatttaaaatatataataataaatcacttacgtttaaaacttgggaatttatagtttagacatcttgcatttaaatcattacaatttaatttaaaatcaccatctgtaaaaatt-aaaaaaaaaatacattaggtattacaaatattatatgcacaatgtatatttatatttcctttttttattctttcttcttttttcta-tttttttatctttatcttttcctttt-----------tgacgtactttttttaaagtagtattcataaaaggcatatataattagcgaagccattaaaaacccaaaaaacaaataaaaaaaggtcttatattttttcagacgttgaaaaaatccattccttggctctacaaacaagaataagtaattttaacatattaaaaatattatacacata----atatatatatatatatatattaaaatagatatatagatttgtacatgtattattatttatttatatgctataattatcttcaaacaaaaaaaaaaaggaaaccatgtctgtttattaacacatgtacatgtaatatat----------------tatatatatatatatatatatatattttaggtgtcataatattttattttgttttgttttttctagttcataccaccatgattatcaacgtctgtattttctgcatcatttaatttattccacatttttc-tttttttttttaataatatataacaaattttaaaactagaaaaaatcaagtttttttcttgttttttttatta-ttttttttttcaacaaatatatattttatataaagatgaatgtatatattatgaatattcaaaaaatataaaaaaaatgttattaatatataatg--------------tatatatatatatatatattataaattacaatattatgaatataactatatttacacc-aaaa-acccccccaaaaaaaaag-aattgcttttttatatcatatacat-----------------------------------------------------------------------------------------------------tatatatatatatattataaaataatagtaggttaaaatttaatatgtttaattaataattattaaaaaa--------------------atatatatatatatatatatatataagaaaaatataattataaaatataattaaaaacagaaatgaatataatatataataattgttatttaaatttgccaaaagatcaaaagttcaataaatattcaaaagc---attattaactaaaggctccataatataaaaaaatatatttcataaataattcttttatacaattataatata-------------------------------atatatatatataataataaataaaagattaaaaaaaaaataaaaattcaacttttctatttttagaaaaaatatatatgaaaaaaaaataagaaataaattta-ggtagttttatttatatagaattcgttaagatctatgatttctttatattatatgtatatgtaaaaaacaaaaaaacaaacaaattagtgttatatatatata-atatatatatataaatattttataataatatatggtttaattttatttta---tattaatacctat-aattatatataata--tatttttttatatatattaaagaatctaatactatgtaacgat---ataatatatatatttctaaaaataattataacaaatttgatcatttatatta-tatatataaaa-aaccctttctttctaaaatcttttaaaaaaaaaaaacccaaataaaaaaagaataatatattataatatatatatatataaagaaaaa------------------------------------------" }
		],
		ranges: {
			one_based: {
				"PPRFG01_11": { "start": 1095661, "end": 1097762 },
				"PRG01_11": { "start": 927947, "end": 930046 },
				"Pf7G8_11": { "start": 998163, "end": 1000264 },
				"Pf7G8_tig00000002_pilon": { "start": 997543, "end": 999644 },
				"PfCD01_11": { "start": 1057592, "end": 1059693 },
				"PfDd2_11": { "start": 972144, "end": 974245 },
				"PfGA01_11": { "start": 1033048, "end": 1035149 },
				"PfGB4_11": { "start": 1101523, "end": 1103624 },
				"PfGN01_11": { "start": 1023095, "end": 1025196 },
				"PfHB3_11": { "start": 977097, "end": 979198 },
				"PfIT_11": { "start": 1022184, "end": 1024286 },
				"PfKE01_11": { "start": 1028529, "end": 1030630 },
				"PfKH01_11": { "start": 1015949, "end": 1018050 },
				"PfKH02_11": { "start": 1055929, "end": 1058031 },
				"PfML01_00_142": { "start": 19533, "end": 21635 },
				"PfNF135_tig00000002_pilon": { "start": 1022177, "end": 1024278 },
				"PfNF54_tig00000031_pilon": { "start": 970753, "end": 972854 },
				"PfSD01_11": { "start": 952152, "end": 954253 },
				"PfSN01_11": { "start": 972127, "end": 974228 },
				"PfTG01_11": { "start": 1017474, "end": 1019575 },
				"Pfsa3_101": { "start": 1057985, "end": 1058085 },
				"Pf3D7_11_v3": { "start": 1056984, "end": 1059085 }
			}
		},
		"genes": [
			{ "chromosome": "Pf3D7_11_v3", "ID": "PF3D7_1127000", "feature": "gene", "parent": "NA", "start": 1056198, "end": 1058054, "strand": "-" },
			{ "chromosome": "Pf3D7_11_v3", "ID": "PF3D7_1127000.1", "feature": "mRNA", "parent": "PF3D7_1127000", "start": 1056198, "end": 1058054, "strand": "-" },
			{ "chromosome": "Pf3D7_11_v3", "ID": "exon_PF3D7_1127000-E1", "feature": "exon", "parent": "PF3D7_1127000.1", "start": 1058003, "end": 1058054, "strand": "-" },
			{ "chromosome": "Pf3D7_11_v3", "ID": "PF3D7_1127000.1-p1-CDS1", "feature": "CDS", "parent": "PF3D7_1127000.1", "start": 1058003, "end": 1058054, "strand": "-" }
		],
		"region": {
			"chromosome": "Pf3D7_11_v3",
			"start": 1057985,
			"end": 1058085 
		}
	} ;
</script>
<script>

	function assert(condition, message) {
		if (!condition) {
			throw new Error(message || "Assertion failed");
		}
	}

	let computeUngappedSequence = function( gappedSequence, coordinateRange ) {
		let ranges = [] ;
		let range = {
			inAlignment: {start: 0, end: 0 },
			inSequence: {start: 0, end: 0 }
		} ;
		let firstAlignmentBase = 0 ;
		let lastAlignmentBase = 0 ;
		let inRange = false ;
		let sequencePosition = 0 ;
		let ungappedSequence = [] ;
		for( let i = 0; i < gappedSequence.length; ++i ) {
			if( gappedSequence[i] == "-" && inRange ) {
				range.inAlignment.end = i ;
				range.inSequence.end = coordinateRange.start + ungappedSequence.length ;
				// take care here to push a newly-built range object otherwise
				// they all refer to the same one.
				ranges.push( {
					inAlignment: {
						start: range.inAlignment.start,
						end: range.inAlignment.end
					},
					inSequence: {
						start: range.inSequence.start,
						end: range.inSequence.end
					}
				} ) ;
				inRange = false ;
				lastAlignmentBase = i ;
			} else if( gappedSequence[i] != "-" && !inRange ) {
				range.inAlignment.start = i ;
				range.inSequence.start = coordinateRange.start + ungappedSequence.length ;
				inRange = true ;
				if( ranges.length == 0 ) {
					firstAlignmentBase = i ;
				}
			}
			if( gappedSequence[i] != "-" ) {
				ungappedSequence.push( gappedSequence[i] ) ;
			}
		}
		//console.log( "S", gappedSequence, ungappedSequence ) ;
		// sanity check
		assert(
			ungappedSequence.length == (coordinateRange.end - coordinateRange.start),
			(
				"!! ERROR: computeUngappedSequence(): sequence length (" +
				ungappedSequence.length +
				") does not match coordinate range (" +
				coordinateRange.start + " - " + coordinateRange.end +
				 " (length " + (coordinateRange.end - coordinateRange.start) + ")."
			)
		) ;
		
		return {
			sequence: ungappedSequence,
			ranges: ranges,
			alignmentSequenceRange: { start: firstAlignmentBase, end: lastAlignmentBase },
			sequenceCoordinateRange: coordinateRange
		} ;
	} ;

	// scales that map sequence coords to MSA coords
	let MSAScales = function( alignment ) {
		this.alignment = alignment ;
		this.alignmentLength = alignment[0].sequence.length ;
		this.ungappedSequences = {} ;
		this.ranges = {} ;
		
		for( let i = 0; i < alignment.length; ++i ) {
			let gappedSequence = alignment[i].sequence ;
			assert(
				gappedSequence.length == this.alignmentLength,
				"!! MSAScales(): error: length of sequence "
					+ i + " (" + gappedSequence.length
					+ ") does not match length of first sequence ("
					+ this.alignmentLength +" )"
			) ;
			let range = data.ranges.one_based[ alignment[i].name ] ;
			let ungapped = computeUngappedSequence(
				gappedSequence,
				{
					start: range.start,
					end: range.end + 1
				}
			) ;
			let scales = [] ;
			for( let j = 0; j < ungapped.ranges.length; ++j ) {
				let range = ungapped.ranges[j] ;
				scales.push(
					new d3.scaleLinear()
						.domain( [ range.inSequence.start, range.inSequence.end ] )
						.range( [ range.inAlignment.start, range.inAlignment.end ] )
				) ;
			}
			this.ranges[alignment[i].name] = scales ;
			this.ungappedSequences[alignment.name] = ungapped ;
		}
		this.global = d3.scaleLinear()
			.domain( [0, this.alignmentLength] )
			.range( [0, this.alignmentLength] )
		;
		return this ;
	} ;

	let MSA = function( alignment ) {
		this.alignment = alignment ;
		this.n = alignment.length ;
		this.scales = new MSAScales( alignment )
		this.alignmentLength = this.scales.alignmentLength ;
		return this ;
	} ;
</script>
<script>
	// Turn sequence strings into arrays.
	// TODO: move this to the plot-msa generation code.
	for( let i = 0; i < data.alignment.length; ++i ) {
		data.alignment[i].sequence = data.alignment[i].sequence.split( "" ) ;
	}

	let config = {
		baseWidth: 2,
		baseHeight: 8,
		sequenceHeight: 20
	} ;

	let msa = new MSA( data.alignment ) ;
	let refSequenceName = data.alignment[data.alignment.length-1].name ;
	let reference = computeUngappedSequence(
		data.alignment[data.alignment.length-1].sequence,
		{
			start: data.ranges.one_based[refSequenceName].start,
			end: data.ranges.one_based[refSequenceName].end + 1
		}
	) ;
	reference.name = refSequenceName ;
	reference.range = reference.sequenceCoordinateRange ;
	reference.range.chromosome = reference.name ;
	
	let MSAViewer = function(
		elt,
		msa,
		reference,
		genes,
		geom = {
			layout: {
				baseHeight: 8,
				sequenceHeight: 20,
				width: {
					all: window.innerWidth - 40,
					names: 200,
					sequences: window.innerWidth - 240,
					reference: window.innerWidth - 240
				},
				genePanelHeight: 100
			},
			margin: {
				top: 20,
				bottom: 20,
				left: 10,
				right: 10
			}
		}
	) {
		this.elt = elt ;
		this.panels = {
			names: elt.select( "svg.names" ),
			sequences: elt.select( "canvas.sequences" ),
			genes: elt.select( "svg.genes" )
		} ;
		this.msa = msa ;
		this.reference = reference ;
		this.genes = genes ;
		this.geom = geom ;
		this.geom.layout.height = ((msa.alignment.length + 2) * geom.layout.sequenceHeight) + geom.margin.top + geom.margin.bottom ;

		this.scales = function(){
			let result = {} ;
			result.y = new d3.scaleBand()
				.domain( msa.alignment.map( d => d.name ).concat( ["", "reference"] ))
				.range( [ geom.margin.top, geom.layout.height - geom.margin.top ] ) ;
			result.x = new d3.scaleLinear()
				.domain( msa.scales.global.range() )
				.range( [ geom.margin.left, geom.layout.width.sequences - geom.margin.right ] ) ;
			result.reference = new d3.scaleLinear()
				.domain( [ reference.range.start, reference.range.end ] )
				.range( result.x.range() ) ;
			result.alignmentReferenceMap = new d3.scaleLinear()
				.domain( msa.scales.global.range() )
				.range( result.reference.domain() )
			;
			result.genes = new d3.scaleLinear()
				.domain( [Math.max( genes.numberOfLevels, 5 ), 0] )
				.range( [10, geom.layout.genePanelHeight - geom.margin.bottom ] ) ;
			return result ;
		}() ;
		
		this.aes = {
			bases: {
				'-': { 'colour': 'lightgrey', "offset": -1, "height": 2 },
				'a': { 'colour': 'red', "offset": -4, "height": 8 },
				't': { 'colour': 'blue', "offset": -4, "height": 8 },
				'c': { 'colour': 'green', "offset": -4, "height": 8 },
				'g': { 'colour': 'orange', "offset": -4, "height": 8 }
			}
		} ;
		
		return this ;
	}

	MSAViewer.prototype.setViewport = function( viewport ) {
		//assert( end >= start && start >= 0 ) ;
		this.scales.x.domain( viewport ) ;
		let ranges = this.msa.scales.ranges[ this.msa.alignment[ this.msa.alignment.length - 1 ].name ] ;
		let choice = { left: -1, right: -1 } ;
		for( let i = 0; i < ranges.length; ++i ) {
			let range = ranges[i] ;
			if( range.range()[1] >= viewport[0] && choice.left == -1 ) {
				choice.left = i ;
			}
			if( range.range()[0] < viewport[1] ) {
				choice.right = i ;
			}
		}
		let lr = ranges[choice.left] ;
		let rr = ranges[choice.right] ;
		
		let refViewport = [
			lr.invert( Math.max( viewport[0], lr.range()[0] )),
			rr.invert( Math.min( viewport[1], rr.range()[1] ))
		] ;

		this.scales.reference.domain( refViewport ) ;
	} ;

	MSAViewer.prototype.viewport = function() {
		// current view coordinates, in msa coordinates
		return this.scales.x.domain() ;
	} ;

	MSAViewer.prototype.updateLayout = function() {
		let geom = this.geom ;
		geom.layout.width.all = window.innerWidth - 40 ;
		geom.layout.width.sequences = window.innerWidth - geom.layout.width.names - 40 ;
		geom.layout.width.reference = window.innerWidth - geom.layout.width.names - 40 ;
		this.scales.x.range( [ geom.margin.left, geom.layout.width.sequences - geom.margin.right ] ) ;
	}
	
	MSAViewer.prototype.draw = function() {
		let panels = this.panels ;
		// Ensure we fit the screen.
		this.updateLayout() ;
		let geom = this.geom ;
		let vs = this.scales ;
		let aes = this.aes ;
	
		// put panels in the right place
		d3.select( '.figure' )
			.attr( 'width', geom.layout.width.all )
			.attr( 'height', geom.layout.height + 300 ) ;
	
		panels.names.attr( 'width', geom.layout.width.names ) ;
		panels.names.attr( 'height', geom.layout.height ) ;

		panels.sequences.attr( 'width', geom.layout.width.sequences ) ;
		panels.sequences.attr( 'height', geom.layout.height ) ;

		panels.genes.style( 'top', geom.layout.height + 20 ) ;
		panels.genes.attr( 'width', geom.layout.width.reference ) ;

		panels.sequences.selectAll('*').remove() ;
		
		{
			let renderName = function( selection ) {
				selection
					.append( 'text' )
					.attr( 'x', 0 )
					.attr( 'y', 0 )
					.attr( 'text-anchor', 'end' )
					.attr( 'alignment-baseline', 'middle' )
					.attr( 'font-size', '10pt')
					.attr( 'font-family', 'Palatino' )
					.text( name => name ) ;
			} ;
			let names = panels.names.selectAll( 'g.name' )
				.data( data.alignment.map( elt => elt.name ).concat( [ "reference" ]) )
				.enter()
				.append( 'g' )
				.attr( "class", "name" )
				.attr( 'transform', ( name, i ) => ('translate(' + (geom.layout.width.names - geom.margin.right) + ',' + vs.y(name) + ")" ))
			;
			names.call( renderName ) ;
		}

		{
			let genes = this.genes ;
			
			genes.draw(
				panels.genes, {
					position: vs.reference,
					level: vs.genes
				}
			) ;
			let axis = panels.genes.selectAll( 'g.axis' ).data( ['axis' ]) ;
			axis
				.enter()
				.append( 'g' )
				.attr( 'class', 'axis' )
			axis
				.attr( 'transform', 'translate( 0,' + ( vs.genes.range()[1] + 10) + ')' )
				.call( d3.axisBottom( vs.reference )) ;
		}

		let drawSequence = function( sequence, y, baseWidth, xScale, lower, upper, ctx ) {
			let by = Math.max( 1, Math.floor( 1.0/baseWidth )) ;
			for( let j = lower; j < upper; j += by ) {
				let base = sequence[j] ;
				let base_aes = aes.bases[base] ;
				ctx.fillStyle = base_aes.colour ;
				ctx.fillRect(
					xScale( j ),
					y + base_aes.offset,
					Math.max( baseWidth, 1 ),
					base_aes.height
				) ;
			}
		} ;

		{
			let sequences = panels.sequences.node() ;
			let ctx = sequences.getContext( '2d' ) ;
			let viewport = this.viewport() ;
			let baseWidth = vs.x(1) - vs.x(0) ;
			for( let i = 0; i < msa.alignment.length; ++i ) {
				let sequence = msa.alignment[i].sequence ;
				drawSequence(
					msa.alignment[i].sequence,
					vs.y(msa.alignment[i].name ),
					baseWidth,
					j => vs.x( msa.scales.global(j)),
					Math.max( Math.floor( viewport[0] ), 0 ),
					Math.min( Math.ceil( viewport[1] ), sequence.length ),
					ctx
				) ;
			}
			
			drawSequence(
				reference.sequence,
				vs.y( "reference" ),
				vs.reference(1) - vs.reference(0),
				j => vs.reference(reference.range.start + j),
				0,
				reference.sequence.length,
				ctx
			) ;
			
			{
				let gs = msa.scales.global ;
				let yoffset = geom.layout.baseHeight + 2 ;
				let ys = {
					"a": vs.y( "reference" ) - (2 * (geom.layout.sequenceHeight - yoffset)),
					"b": vs.y( "reference" ) - yoffset
				} ;
				for( let i = 0; i < reference.ranges.length; ++i ) {
					let range = reference.ranges[i] ;
					let x00 = vs.x( gs( range.inAlignment.start )) ;
					let x01 = vs.reference( range.inSequence.start ) ;
					let x11 = vs.reference( range.inSequence.end ) ;
					let x10 = vs.x( gs( range.inAlignment.end )) ;
					ctx.beginPath() ;
					// ref sequence is 2 * sequenceHeight down.
					ctx.moveTo( x00, ys.a ) ;
					ctx.lineTo( x01, ys.b ) ;
					ctx.moveTo( x11, ys.b ) ;
					ctx.lineTo( x10, ys.a ) ;
					ctx.strokeStyle = "grey" ;
					ctx.stroke() ;
				}
			}
		}

	}

	let viewer = new MSAViewer(
			d3.select( ".figure" ),
			msa,
			reference,
			new GeneView( data.genes, reference.range )
	) ;
	viewer.draw() ;

	let Control = function( elt, viewer ) {
		this.elt = elt ;
		this.viewer = viewer ;
		this.drag = { start: 0 } ;
		let self = this ;
		let doDrag = function( x ) {
			let here = self.viewer.scales.x.invert( x ) ;
			let drag = here - self.drag.start ;
			let viewport = self.viewer.viewport() ;
			drag = Math.min( drag, viewport[0] - self.viewer.msa.scales.global.range()[0] + 50 ) ;
			drag = Math.max( drag, viewport[1] - self.viewer.msa.scales.global.range()[1] - 50 ) ;
			console.log( "     DRAG", self.drag, self.viewport, self.viewer.msa.scales.global.range(), drag ) ;
			self.viewer.setViewport( [ viewport[0] - drag, viewport[1] - drag ] ) ;
			self.viewer.draw() ;
		} ;
		
		// set up dragging
		elt.on( "mousedown", function( e ) {
//			self.dragging = true ;
//			self.dragStartRegion = self.viewport ;
//			self.dragStartCentre = (self.viewport[1] + self.viewport[0])/2 ;
			self.drag.start = self.viewer.scales.x.invert( e.offsetX ) ;
			self.dragging = true ;
			console.log( "START DRAG", e.offsetX, e.offsetY, self.drag ) ;
		}) ;
		elt.on( "mousemove", function( e ) {
			if( self.dragging ) {
				doDrag( e.offsetX ) ;
			}
		}) ;
		elt.on( "mouseup", function(e) {
			if( self.dragging ) {
				doDrag( e.offsetX ) ;
				self.dragging = false ;
			}
		}) ;
		elt.on( "mouseout", function(e) {
			if( self.dragging ) {
				doDrag( e.offsetX ) ;
				self.dragging = false ;
			}
		}) ;
		
		let zoomRegion = function( viewport, focus, zoom ) {
			// Expand or contract region around given centre point
			// which must lie in the region.
			// The way this works is that the chosen point stays fixed on the screen
			// And everything else zooms.
			// zoom=1 means no zoom
			// zoom>1 means zoom in
			// zoom<1 means zoom out
			return(
					[
						focus + ((viewport[0] - focus) / zoom),
						focus + ((viewport[1] - focus) / zoom)
					]
			) ;
		} ;
		// Set up zooming
		elt.on( 'mousewheel', function(e) {
			let viewport = self.viewer.viewport() ;
			let focus = self.viewer.scales.x.invert( e.offsetX ) ;
		//	console.log( "zooming:", e.wheelDeltaY, viewport, focus, self.viewer.msa ) ;
			
			if( e.wheelDeltaY > 0 && (viewport[1] - viewport[0]) > 100 ) {
				let scale = Math.pow( 2, Math.min( e.wheelDeltaY, 50.0 ) / 50.0 ) ;
				self.viewer.setViewport(
					zoomRegion( viewport, focus, scale )
				) ;
				self.viewer.draw() ;
			}
			else if( e.wheelDeltaY < 0 && (viewport[1] - viewport[0]) < ( self.viewer.msa.alignmentLength )) {
				let scale = Math.pow( 2, Math.min( -e.wheelDeltaY, 50.0 ) / 50.0 ) ;
				let viewport = zoomRegion( self.viewer.viewport(), focus, 1/scale ) ;
				viewport[0] = Math.max( viewport[0], 0 ) ;
				viewport[1] = Math.min( viewport[1], self.viewer.msa.alignmentLength ) ;
				self.viewer.setViewport( viewport ) ;
				self.viewer.draw() ;
			}
			e.stopPropagation() ;
			return false ;
		}) ;
		
	} ;
	
	let control = new Control( d3.select( 'canvas.sequences'), viewer ) ;

</script>
</html>
